# MetaMask Login & Bot Management - AIP DEX Trading Bot

## æ¦‚è¿°

æ–°çš„MetaMaskç™»å½•ç³»ç»Ÿå…è®¸ç”¨æˆ·é€šè¿‡MetaMaské’±åŒ…è¿›è¡Œèº«ä»½éªŒè¯ï¼Œè®¤é¢†æœªé…ç½®çš„äº¤æ˜“æœºå™¨äººï¼Œå¹¶åˆ›å»ºå’Œç®¡ç†äº¤æ˜“ç­–ç•¥ã€‚

## ä¸»è¦åŠŸèƒ½

### 1. MetaMask é’±åŒ…ç™»å½•

- **å®‰å…¨è®¤è¯**ï¼šä½¿ç”¨MetaMaské’±åŒ…è¿›è¡Œèº«ä»½éªŒè¯
- **è‡ªåŠ¨ç”¨æˆ·åˆ›å»º**ï¼šé¦–æ¬¡ç™»å½•æ—¶è‡ªåŠ¨åˆ›å»ºç”¨æˆ·è´¦æˆ·
- **æŒä¹…ç™»å½•**ï¼šç™»å½•çŠ¶æ€æŒä¹…åŒ–ä¿å­˜
- **å¤šé“¾æ”¯æŒ**ï¼šæ”¯æŒä»¥å¤ªåŠã€BSCç­‰ç½‘ç»œ

### 2. Bot è®¤é¢†ç³»ç»Ÿ

- **æŸ¥çœ‹æœªè®¤é¢†çš„Bot**ï¼šæ˜¾ç¤ºæ‰€æœ‰æ²¡æœ‰ownerçš„æœºå™¨äºº
- **ä¸€é”®è®¤é¢†**ï¼šè¿æ¥MetaMaskåå¯ä»¥è®¤é¢†æœºå™¨äºº
- **æ‰€æœ‰æƒéªŒè¯**ï¼šç¡®ä¿åªæœ‰é’±åŒ…æ‰€æœ‰è€…å¯ä»¥è®¤é¢†

### 3. ç­–ç•¥ç®¡ç†ç³»ç»Ÿ

- **åˆ›å»ºè‡ªå®šä¹‰ç­–ç•¥**ï¼šç”¨æˆ·å¯ä»¥åˆ›å»ºè‡ªå·±çš„äº¤æ˜“ç­–ç•¥
- **ç­–ç•¥å‚æ•°é…ç½®**ï¼šè®¾ç½®ä»“ä½å¤§å°ã€æ­¢æŸã€æ­¢ç›ˆç­‰å‚æ•°
- **ç­–ç•¥ç±»å‹é€‰æ‹©**ï¼šæ”¯æŒä¿å®ˆå‹ã€å¹³è¡¡å‹ã€æ¿€è¿›å‹ç­‰ç­–ç•¥
- **ç­–ç•¥æè¿°**ï¼šè¯¦ç»†çš„ä¹°å…¥ã€å–å‡ºã€ç­›é€‰ç­–ç•¥æè¿°

### 4. Bot é…ç½®ç³»ç»Ÿ

- **ç­–ç•¥å…³è”**ï¼šä¸ºè®¤é¢†çš„æœºå™¨äººé…ç½®äº¤æ˜“ç­–ç•¥
- **çµæ´»é…ç½®**ï¼šæ”¯æŒéšæ—¶æ›´æ¢ç­–ç•¥
- **é…ç½®éªŒè¯**ï¼šç¡®ä¿é…ç½®çš„æœ‰æ•ˆæ€§

## é¡µé¢ç»“æ„

### 1. ç™»å½•é¡µé¢ (`/login`)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           MetaMask Login            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¤– AIP DEX Trading Bot            â”‚
â”‚  Connect your MetaMask wallet      â”‚
â”‚                                     â”‚
â”‚  [Connect MetaMask]                â”‚
â”‚                                     â”‚
â”‚  Features:                         â”‚
â”‚  âœ… Secure wallet authentication    â”‚
â”‚  âœ… Claim unclaimed trading bots   â”‚
â”‚  âœ… Configure trading strategies   â”‚
â”‚  âœ… Manage your trading portfolio  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Botç®¡ç†é¡µé¢ (`/bot-management`)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Bot Management              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Unclaimed Bots                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Bot 1   â”‚ â”‚ Bot 2   â”‚ â”‚ Bot 3   â”‚â”‚
â”‚  â”‚ [Claim] â”‚ â”‚ [Claim] â”‚ â”‚ [Claim] â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                     â”‚
â”‚  My Strategies                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚Strategy1â”‚ â”‚Strategy2â”‚ â”‚Strategy3â”‚â”‚
â”‚  â”‚Type: Modâ”‚ â”‚Type: Aggâ”‚ â”‚Type: Conâ”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                     â”‚
â”‚  My Claimed Bots                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚My Bot 1 â”‚ â”‚My Bot 2 â”‚ â”‚My Bot 3 â”‚â”‚
â”‚  â”‚[Config] â”‚ â”‚[Config] â”‚ â”‚[Config] â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä½¿ç”¨æµç¨‹

### 1. ç”¨æˆ·ç™»å½•æµç¨‹

```mermaid
graph TD
    A[è®¿é—®ç™»å½•é¡µé¢] --> B[ç‚¹å‡»Connect MetaMask]
    B --> C[MetaMaskå¼¹å‡ºè¿æ¥è¯·æ±‚]
    C --> D[ç”¨æˆ·ç¡®è®¤è¿æ¥]
    D --> E[è·å–é’±åŒ…åœ°å€]
    E --> F[ç”Ÿæˆç­¾åæ¶ˆæ¯]
    F --> G[ç”¨æˆ·ç­¾å]
    G --> H[å‘é€è®¤è¯è¯·æ±‚]
    H --> I[åˆ›å»ºæˆ–è·å–ç”¨æˆ·è´¦æˆ·]
    I --> J[ç™»å½•æˆåŠŸ]
    J --> K[è·³è½¬åˆ°ä¸»é¡µé¢]
```

### 2. Botè®¤é¢†æµç¨‹

```mermaid
graph TD
    A[æŸ¥çœ‹æœªè®¤é¢†çš„Bot] --> B[é€‰æ‹©è¦è®¤é¢†çš„Bot]
    B --> C[ç‚¹å‡»Claim Bot]
    C --> D[éªŒè¯MetaMaskè¿æ¥]
    D --> E[å‘é€è®¤é¢†è¯·æ±‚]
    E --> F[éªŒè¯é’±åŒ…åœ°å€]
    F --> G[æ›´æ–°Botæ‰€æœ‰æƒ]
    G --> H[è®¤é¢†æˆåŠŸ]
    H --> I[Botå‡ºç°åœ¨My Botsåˆ—è¡¨]
```

### 3. ç­–ç•¥åˆ›å»ºæµç¨‹

```mermaid
graph TD
    A[ç‚¹å‡»Create Strategy] --> B[å¡«å†™ç­–ç•¥ä¿¡æ¯]
    B --> C[è®¾ç½®ç­–ç•¥å‚æ•°]
    C --> D[ç¼–å†™ç­–ç•¥æè¿°]
    D --> E[æäº¤åˆ›å»ºè¯·æ±‚]
    E --> F[éªŒè¯ç”¨æˆ·èº«ä»½]
    F --> G[åˆ›å»ºç­–ç•¥è®°å½•]
    G --> H[ç­–ç•¥åˆ›å»ºæˆåŠŸ]
    H --> I[ç­–ç•¥å‡ºç°åœ¨My Strategiesåˆ—è¡¨]
```

### 4. Boté…ç½®æµç¨‹

```mermaid
graph TD
    A[é€‰æ‹©å·²è®¤é¢†çš„Bot] --> B[ç‚¹å‡»Configure Bot]
    B --> C[é€‰æ‹©äº¤æ˜“ç­–ç•¥]
    C --> D[æŸ¥çœ‹ç­–ç•¥è¯¦æƒ…]
    D --> E[ç¡®è®¤é…ç½®]
    E --> F[å‘é€é…ç½®è¯·æ±‚]
    F --> G[æ›´æ–°Boté…ç½®]
    G --> H[é…ç½®æˆåŠŸ]
    H --> I[Botå¯ä»¥å¼€å§‹äº¤æ˜“]
```

## API ç«¯ç‚¹

### è®¤è¯ç›¸å…³

- `POST /api/v1/auth/metamask` - MetaMaskèº«ä»½éªŒè¯
- `GET /api/v1/bots/unclaimed` - è·å–æœªè®¤é¢†çš„Bot
- `POST /api/v1/bots/{bot_id}/claim` - è®¤é¢†Bot
- `POST /api/v1/bots/{bot_id}/configure` - é…ç½®Bot

### ç­–ç•¥ç®¡ç†

- `POST /api/v1/strategies` - åˆ›å»ºç­–ç•¥
- `GET /api/v1/strategies/owner/{owner_id}` - è·å–ç”¨æˆ·çš„ç­–ç•¥

## æ•°æ®åº“ç»“æ„

### BotOwner è¡¨
```sql
CREATE TABLE bot_owners (
    id UUID PRIMARY KEY,
    owner_name VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    wallet_address VARCHAR(100) UNIQUE NOT NULL,
    subscription_tier VARCHAR(20) DEFAULT 'basic',
    max_bots_allowed INTEGER DEFAULT 5,
    created_at TIMESTAMP DEFAULT NOW()
);
```

### TradingStrategy è¡¨
```sql
CREATE TABLE trading_strategies (
    id UUID PRIMARY KEY,
    owner_id UUID REFERENCES bot_owners(id),
    strategy_name VARCHAR(100) NOT NULL,
    strategy_type VARCHAR(30) NOT NULL,
    risk_level VARCHAR(20) NOT NULL,
    max_position_size DECIMAL(5,2) NOT NULL,
    stop_loss_percentage DECIMAL(5,2) NOT NULL,
    take_profit_percentage DECIMAL(5,2) NOT NULL,
    buy_strategy_description TEXT,
    sell_strategy_description TEXT,
    filter_strategy_description TEXT,
    created_at TIMESTAMP DEFAULT NOW()
);
```

### TradingBot è¡¨ï¼ˆæ›´æ–°ï¼‰
```sql
ALTER TABLE trading_bots ADD COLUMN owner_id UUID REFERENCES bot_owners(id);
ALTER TABLE trading_bots ADD COLUMN is_configured BOOLEAN DEFAULT FALSE;
```

## å®‰å…¨ç‰¹æ€§

### 1. é’±åŒ…éªŒè¯
- éªŒè¯MetaMaské’±åŒ…åœ°å€çš„æœ‰æ•ˆæ€§
- ä½¿ç”¨ç­¾åéªŒè¯ç”¨æˆ·èº«ä»½
- é˜²æ­¢åœ°å€ä¼ªé€ å’Œé‡æ”¾æ”»å‡»

### 2. æƒé™æ§åˆ¶
- åªæœ‰Botæ‰€æœ‰è€…å¯ä»¥é…ç½®Bot
- ç­–ç•¥åªèƒ½è¢«åˆ›å»ºè€…ä½¿ç”¨
- é˜²æ­¢æœªæˆæƒè®¿é—®

### 3. æ•°æ®éªŒè¯
- è¾“å…¥å‚æ•°éªŒè¯
- ç­–ç•¥å‚æ•°èŒƒå›´æ£€æŸ¥
- é˜²æ­¢æ¶æ„æ•°æ®æ³¨å…¥

## é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯

1. **MetaMaskæœªå®‰è£…**
   ```
   MetaMask is not installed. Please install MetaMask to continue.
   ```

2. **ç”¨æˆ·æ‹’ç»è¿æ¥**
   ```
   User rejected the connection request.
   ```

3. **Botå·²è¢«è®¤é¢†**
   ```
   Bot is already claimed by another user.
   ```

4. **ç­–ç•¥åˆ›å»ºå¤±è´¥**
   ```
   Failed to create strategy: Invalid parameters
   ```

### è°ƒè¯•æŠ€å·§

1. æ£€æŸ¥MetaMaskè¿æ¥çŠ¶æ€
2. éªŒè¯é’±åŒ…åœ°å€æ ¼å¼
3. ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
4. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

## æœ€ä½³å®è·µ

### 1. ç”¨æˆ·ä½“éªŒ

- æä¾›æ¸…æ™°çš„æ“ä½œæŒ‡å¼•
- æ˜¾ç¤ºæ“ä½œè¿›åº¦å’ŒçŠ¶æ€
- å‹å¥½çš„é”™è¯¯æç¤ºä¿¡æ¯
- å“åº”å¼è®¾è®¡é€‚é…ç§»åŠ¨ç«¯

### 2. å®‰å…¨æ€§

- å®šæœŸæ›´æ–°ä¾èµ–åŒ…
- å®æ–½é€Ÿç‡é™åˆ¶
- è®°å½•å®‰å…¨äº‹ä»¶æ—¥å¿—
- å®šæœŸå®‰å…¨å®¡è®¡

### 3. æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨ç¼“å­˜å‡å°‘æ•°æ®åº“æŸ¥è¯¢
- å¼‚æ­¥å¤„ç†è€—æ—¶æ“ä½œ
- å‹ç¼©é™æ€èµ„æº
- å®æ–½CDNåŠ é€Ÿ

## éƒ¨ç½²è¯´æ˜

### 1. ç¯å¢ƒè¦æ±‚

- Node.js 16+
- MetaMaskæµè§ˆå™¨æ‰©å±•
- æ”¯æŒWeb3çš„ç°ä»£æµè§ˆå™¨

### 2. é…ç½®é¡¹

```env
# MetaMaské…ç½®
METAMASK_NETWORK_ID=1  # ä¸»ç½‘
METAMASK_CHAIN_ID=0x1  # åå…­è¿›åˆ¶é“¾ID

# å®‰å…¨é…ç½®
JWT_SECRET=your-jwt-secret
SESSION_SECRET=your-session-secret

# æ•°æ®åº“é…ç½®
DATABASE_URL=postgresql://user:pass@localhost/db
```

### 3. å¯åŠ¨å‘½ä»¤

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# åˆå§‹åŒ–æ•°æ®åº“
python reset_trading_bot_tables.py

# å¯åŠ¨æœåŠ¡
python main.py --port 8000
```

## æ€»ç»“

MetaMaskç™»å½•å’ŒBotç®¡ç†ç³»ç»Ÿæä¾›äº†ï¼š

- **å®‰å…¨çš„èº«ä»½éªŒè¯**ï¼šåŸºäºMetaMaské’±åŒ…çš„å¯é èº«ä»½éªŒè¯
- **çµæ´»çš„Botç®¡ç†**ï¼šæ”¯æŒBotè®¤é¢†å’Œé…ç½®
- **å¼ºå¤§çš„ç­–ç•¥ç³»ç»Ÿ**ï¼šç”¨æˆ·å¯ä»¥åˆ›å»ºå’Œç®¡ç†è‡ªå®šä¹‰ç­–ç•¥
- **ç”¨æˆ·å‹å¥½çš„ç•Œé¢**ï¼šç›´è§‚çš„æ“ä½œç•Œé¢å’Œæ¸…æ™°çš„çŠ¶æ€åé¦ˆ
- **å®Œæ•´çš„é”™è¯¯å¤„ç†**ï¼šå…¨é¢çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º

è¿™ä¸ªç³»ç»Ÿä¸ºAIP DEXäº¤æ˜“æœºå™¨äººæä¾›äº†å®Œæ•´çš„ç”¨æˆ·ç®¡ç†å’Œé…ç½®åŠŸèƒ½ï¼Œè®©ç”¨æˆ·å¯ä»¥è½»æ¾åœ°ç®¡ç†è‡ªå·±çš„äº¤æ˜“æœºå™¨äººå’Œç­–ç•¥ã€‚ 